function map = parula_colormap(n)
%PARULY Blueish-greenish-orangey-yellowish color map mimics, but 
% does not exactly match, the default parula color map introduced 
% in Matlab R2014b.  
% 
% Syntax and Description:
% map = paruly(n) returns an n-by-3 matrix containing a parula-like 
% colormap. If n is not specified, a value of 64 is used. 
% 
% Chad A. Greene. The University of Texas at Austin. 
% 
% See also AUTUMN, BONE, COOL, COPPER, FLAG, GRAY, HOT, HSV,
% JET, LINES, PINK, SPRING, SUMMER, WINTER, COLORMAP.

if nargin==0
    n = 64; 
end
assert(isscalar(n)==1,'paruly input must be a scalar.') 

R = [47920986.9845841, -432002789.961282, 1661169948.99912, -3328209661.13657, ...
     2708603217.88626, 3475566512.89112, -14225668415.7445, 23164115071.2720, ...
     -24467511476.1342, 18546728112.8514, -10457617267.0848, 4438525756.52115, ...
     -1415345262.44771, 334628886.548897, -57176214.1899078 ,6769646.99828671, ...
     -519953.565824257, 23439.8810049338, -544.946889629835, 5.15413211632107, ...
     0.200909555611123];
G = [197305387.967731, -1925711190.84183, 8716944379.05960, -24297299084.9147, ...
     46695527134.3723, -65652015186.8817, 69922556706.2649, -57634757763.3276, ...
     37243804342.6212, -18997216547.5248, 7663150613.75323, -2437617957.87483, ...
     606395040.065959, -116132918.873322, 16670219.7935428, -1716627.28665654, ...
     118246.594923277, -4898.51327391422, 105.770980145826, 0.591540259267455, ...
     0.167447289862944];
B = [1058482033.44853, -10748732834.0071, 50517346203.7914, -145801965208.361, ...
     289144750640.383, -417695642652.491, 454671842221.995, -380534553294.152, ...
     247676664244.303, -125979265217.504, 50051575381.9942, -15444738162.7808, ...
     3659928686.04537, -653929236.498032, 85661200.2538053, -7885370.81078983, ...
     478474.328246893, -17443.0004135579, 332.002511499741, 0.583692035048707, ...
     0.531791023379267];

x = linspace(0,1,n)'; 

r = polyval(R,x);
g = polyval(G,x);
b = polyval(B,x);

% Clamp: 
r(r<0)=0; 
g(g<0)=0; 
b(b<0)=0; 
r(r>1)=1; 
g(g>1)=1; 
b(b>1)=1; 

map = [r g b]; 

